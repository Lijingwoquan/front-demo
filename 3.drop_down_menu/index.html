<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>下拉菜单</title>
    <link rel="stylesheet" href="../common.css" />
  </head>
  <body>
    <ul class="nav-ul">
      <li>
        <h3>Golang</h3>
        <ol class="ulson">
          <li>Golang</li>
          <li>Golang</li>
          <li>Golang</li>
          <li>Golang</li>
        </ol>
      </li>

      <li>
        <h3>Golang</h3>
        <ol class="ulson">
          <li>Golang</li>
          <li>Golang</li>
          <li>Golang</li>
          <li>Golang</li>
        </ol>
      </li>

      <li>
        <h3>Golang</h3>
        <ol class="ulson">
          <li>Golang</li>
          <li>Golang</li>
          <li>Golang</li>
          <li>Golang</li>
        </ol>
      </li>

      <li>
        <h3>Golang</h3>
        <ol class="ulson">
          <li>Golang</li>
          <li>Golang</li>
          <li>Golang</li>
          <li>Golang</li>
        </ol>
      </li>
      <div class="sliding"></div>
    </ul>
  </body>
</html>

<script>
  const h3List = document.querySelectorAll("h3");
  const ulSonList = document.querySelectorAll(".ulson");
  let liSonList = [];
  const slidingNode = document.querySelector(".sliding");

  ulSonList.forEach((parent) => {
    let nodes = Array.from(parent.childNodes).filter(
      (node) => node.tagName === "LI"
    );
    liSonList.push(...nodes);
  });

  const changeColor = (opt = {}) => {
    opt.list.forEach((item, index) => {
      item.addEventListener("mouseover", function () {
        if (opt.sliding) {
          let leftPX = index * 150;
          slidingNode.style.left = `${leftPX}px`;
        } else {
          this.style.backgroundColor = opt.targetColor || "rgb(48, 155, 48)";
        }
      });
      item.addEventListener("mouseleave", function () {
        this.style.backgroundColor = opt.defaultColor;
      });
    });
  };

  const changeDispaly = (arr) => {
    arr.forEach((item, index) => {
      item.addEventListener("mouseover", function () {
        ulSonList[index].style.display = "block";
      });
      item.addEventListener("mouseleave", function () {
        ulSonList[index].style.display = "none";
      });
    });
  };

  changeColor({
    list: h3List,
    defaultColor: "rgb(55, 83, 176)",
    sliding: true,
  });
  changeColor({
    list: liSonList,
    defaultColor: "rgb(17, 39, 113)",
    targetColor: "rgb(125, 144, 205)",
  });
  changeDispaly(h3List);
  changeDispaly(ulSonList);
</script>

<style>
  * {
    font-size: 16px;
  }
  body {
    background-color: #625d5d;
  }
  .nav-ul {
    margin: 150px auto;
    width: 600px;
    height: 60px;
    background-color: rgb(55, 83, 176);
    box-shadow: 2px 2px 15px 10px rgba(37, 35, 37, 0.329);
    font-size: 0; /* 解决inline-block的空白问题 */
    position: relative;
  }
  .nav-ul > li {
    width: 150px;
    line-height: 60px;
    text-align: center;
    display: inline-block;
    vertical-align: top;
    /* 设置基准线  如果不设置基准线 */
    /* float: left; */
  }
  .nav-ul li h3:hover {
    cursor: pointer;
    border-radius: 5px;
  }
  .ulson {
    display: none;
    background-color: rgb(17, 39, 113);
    border-radius: 5px;
    box-shadow: 2px 2px 5px 5px rgba(58, 53, 58, 0.329);
  }
  .ulson:hover {
    cursor: pointer;
  }
  .ulson :nth-child(n + 2) {
    border-top: dotted 2px rgb(53, 196, 103);
  }
  .sliding {
    width: 150px;
    height: 60px;
    background-color: rgba(77, 206, 77, 0.589);
    position: absolute;
    left: 0px;
    top: 0px;
    transition: 0.3s ease;
    border-radius: 5px;
    pointer-events: none;
    /* display: none; */
  }
</style>
